### Imputation on the whole SAGA cohort

# gognmNA has Cant/wont answer coded as NA's and contains only the variables chosen to be in the imputation model (and pin to be used in the regression model)

imp<-mice(gognmNA, m=1, maxit=0) # create one imputation to easily specify the methods and prediction matrix
predM<-imp$predictorMatrix
predM[c(1:25), 1]<-0 # Not using a pin variable for imputation
meth<-imp$method
meth[25]<-"logreg" # Use logistic regression for coping ability that is coded as numeric

## PMM - multiple imputation using predictive mean matching 
imp_PMM_m25_WD <- mice(gognmNA,method="pmm",predictorMatrix = predM ,m=25, seed = 71332, print = FALSE,maxit=10) 
save(imp_PMM_m25_WD, file="imp_PMM_m25_WD")

## MICE - multiple imputation using the default settings in mice
imp_MICE_m25_WD <- mice(gognmNA,m=25,predictorMatrix = predM,method=meth, seed = 71332, print = FALSE,maxit=10) 
save(imp_MICE_m25_WD, file="imp_MICE_m25_WD")

## SI  - single imptuation using predictive mean matching
imp_SI_m25_WD <- mice(gognmNA,method="pmm",predictorMatrix = predM,m=1, seed = 71332, print = FALSE,maxit=10) 
save(imp_SI_m25_WD, file="imp_SI_m25_WD")


